---
title: "Rails â€“ ActiveRecordã®ãƒ¡ã‚½ãƒƒãƒ‰ãƒã‚§ãƒ¼ãƒ³ã§ then ã‚’ä½¿ã£ã¦ nil å¯¾ç­– ( å¤‰æ•°ã®å€¤ã®æœ‰ç„¡ã§å‡¦ç†åˆ†å² )"
emoji: "ğŸ–¥"
type: "tech"
topics: ["Rails"]
published: true
published_at: 2023-08-09t23:39
---

# å•é¡Œ

- å¤‰æ•°ã®å€¤ãŒã‚ã‚‹æ™‚ã¯ãã®å€¤ã§çµã‚Šè¾¼ã¿ãŸã„
- å¤‰æ•°ã®å€¤ãŒ nil ã®æ™‚ã¯ä½•ã‚‚çµã‚Šè¾¼ã¿ã‚’ãŠã“ãªã„ãŸããªã„

ã ãŒæ¬¡ã®ã‚ˆã†ãªæ›¸ãæ–¹ã ã¨ ã‚«ãƒ©ãƒ ã®å€¤ãŒ NULL ã®ã‚‚ã®ã‚’çµã‚Šè¾¼ã‚“ã§ã—ã¾ã†

```rb
target_id = nil

User.where(flag: true).where(id: target_id)
```

# è§£æ±º

then ã‚’ä½¿ã£ã¦åˆ†å²ã•ã›ã‚‹

```rb
target_id = nil

User.where(flag: true).then do |relation|
  if target_id
    relation.where(id: target_id)
  else
    relation
  end
end
```

scope ã§ã‚‚å®Ÿç¾ã§ãã‚‹ãŒã“ã¡ã‚‰ã®æ–¹ãŒæ‰‹è»½ãªæ›¸ãæ–¹


# ãƒãƒ£ãƒƒãƒˆãƒ¡ãƒ³ãƒãƒ¼å‹Ÿé›†


ä½•ã‹è³ªå•ã€æ‚©ã¿äº‹ã€ç›¸è«‡ãªã©ã‚ã‚Œã°LINEã‚ªãƒ¼ãƒ—ãƒ³ãƒãƒ£ãƒƒãƒˆã‚‚ã”åˆ©ç”¨ãã ã•ã„ã€‚

https://line.me/ti/g2/eEPltQ6Tzh3pYAZV8JXKZqc7PJ6L0rpm573dcQ




# å…¬é–‹æ—¥æ™‚

2023-08-09
