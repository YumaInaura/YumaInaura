---
title: "Ansible | loopå‡¦ç†ã® with_* ç³»ã‚¹ãƒ†ãƒ¼ãƒˆãƒ¡ãƒ³ãƒˆ"
emoji: "ğŸ–¥"
type: "tech"
topics: ["Ansible"]
published: true
---

## with_list

åå‰ã®é€šã‚Šãƒªã‚¹ãƒˆã‚’å±•é–‹ã§ãã‚‹ã€‚

```yaml
- debug:
    msg: "{{ item }}"
  with_list:
    - hello
    - ansible
    - world
```

## å‡ºåŠ›å†…å®¹

- `hello`
- `ansible`
- `world`


## with_indexed_items

è¦ç´ ã®ä½•ç•ªç›®ã‹ã‚’å¾—ã‚‰ã‚Œã‚‹ã€‚

`item.0` ã«ã¯è¦ç´ é †ç•ªãŒå…¥ã‚Šã€
`item.1` ã«ã¯è¦ç´ ãŒå…¥ã‚‹ã€‚

`item.2` ä»¥é™ã¯ãªã„ã€‚


```yaml
- debug:
    msg: "{{ item.0 }} - {{ item.1 }}"
  with_indexed_items: ["hello", "ansible", "world"]
```

### å‡ºåŠ›å†…å®¹

- `0 - hello`
- `1 - ansible`
- `2 - world`

##  wifh_flattend

ãƒã‚¹ãƒˆã•ã‚ŒãŸé…åˆ—ã§ã‚‚ãƒ•ãƒ©ãƒƒãƒˆã«æ‰±ã£ã¦ãã‚Œã‚‹ã€‚

```yaml
- debug:
    msg: "{{ item }}"
  with_flattened: ["hello", ["ansible", [["world"]]]]
```

### å‡ºåŠ›å†…å®¹

- `hello`
- `ansible`
- `world`

## with_together

è¤‡æ•°é…åˆ—ã‚’çµåˆã—ã¦æ‰±ãˆã‚‹ã€‚

```yaml
- debug:
    msg: "{{ item.0 }} {{ item.1 }} {{ item.2 }}"
  with_together:
    - ["hello1", "hello2", "hello3"]
    - ["ansible1", "ansible2", "ansible3"]
    - ["world1", "world2", "world3"]
```

### å‡ºåŠ›å†…å®¹

- `hello1 ansible1 world1`
- `hello2 ansible2 world2`
- `hello3 ansible3 world3`

## with_dict

è¾æ›¸ ( dicionary ) ã‚’æ‰±ãˆã‚‹ã€‚

```yaml
- debug:
    msg: "{{ item.key }} {{ item.value}}"
  with_dict: { a: "hello", b: "ansible", c: "world" }
```

### å‡ºåŠ›å†…å®¹

- `a hello`
- `b ansible`
- `c world`

## with_sequence

é€£ç¶šã‚’æ‰±ãˆã‚‹ã€‚ `for` æ–‡ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ã€‚

é–‹å§‹ãŒ3ã§ã€çµ‚äº†ãŒ9ã§ã€3ãšã¤ã‚¤ãƒ³ã‚¯ãƒªãƒ¡ãƒ³ãƒˆã™ã‚‹ä¾‹ã€‚

```yaml
- debug:
    msg: "{{ item }}"
  with_sequence: start=3 end=9 stride=3 format=%02x
```

### å‡ºåŠ›å†…å®¹

- `03`
- `06`
- `09`

## with_subelements

ã¡ã‚‡ã£ã¨åˆ†ã‹ã‚Šã«ãã„ãŒã€ `with_subelements` ã®1å€‹ç›®ã«ã¯ãƒ¡ã‚¤ãƒ³ã®è¦ç´ ã‚’æ¸¡ã—ã€2å€‹ç›®ã«ã¯ãã®ã‚µãƒ–è¦ç´ ã‚’æŒ‡å®šã§ãã‚‹ã€‚

```yaml
- debug:
    msg: "name : {{ item.0.name }} , like : {{ item.1 }}"
  with_subelements: 
    - 
      - name: "Alice"
        likes:
          - Apple
          - Banana
          - Microsoft
      - name: Bob
        likes:
        - Soccer
        - Basket
    - likes
```

### å‡ºåŠ›å†…å®¹

- `name : Alice , like : Apple`
- `name : Alice , like : Banana`
- `name : Alice , like : Microsoft`
- `name : Bob , like : Soccer`
- `name : Bob , like : Basket`


## with_nested

æ¸¡ã—ãŸè¦ç´ åŒå£«ã®å…¨çµ„ã¿åˆã‚ã›ã‚’å…¨ã¦å±•é–‹ã™ã‚‹ã€‚
ãŸã¨ãˆã°ã€Œè¦ç´ äºŒå€‹ã®é…åˆ—ã€Œã‚’ã€Œä¸‰ç¨®é¡ã€æ¸¡ã™ã¨ã€2ã®3ä¹—ã§ è¨ˆ8å›ã®ãƒ«ãƒ¼ãƒ—ãŒãŠã“ãªã‚ã‚Œã‚‹ã€‚

```yaml
- debug:
    msg: "{{ item.0 }} {{ item.1 }} {{ item.2 }}"
  with_nested:
    - ["hello", "bye"]
    - ["ansible", "world"]
    - ["strong", "zero"]
```

### å‡ºåŠ›å†…å®¹

- `hello ansible strong`
- `hello world zero`
- `bye ansible strong`
- `bye world zero`
- `hello ansible strong `
- `hello world zero`
- `bye ansible strong`
- `bye world zero`

## with_random_choice

ãã®åã®é€šã‚Šã€ãƒ©ãƒ³ãƒ€ãƒ ã«æŠ½å‡ºã™ã‚‹ã€‚

```yaml
- debug:
    msg: "{{ item }}"
  with_random_choice: ["hello", "ansible", "world"]
  tags: with_random_choice
```

### å‡ºåŠ›å†…å®¹

- `ansible` (ãƒ©ãƒ³ãƒ€ãƒ æŠ½å‡ºãªã®ã§å®Ÿè¡Œã®ãŸã³ã«å¤‰ã‚ã‚‹)

# ç’°å¢ƒ

- ansible 2.5.4 

# å‚è€ƒ

- https://docs.ansible.com/ansible/latest/user_guide/playbooks_loops.html








<!-- Update From Qiita API -->

# ãƒãƒ£ãƒƒãƒˆãƒ¡ãƒ³ãƒãƒ¼å‹Ÿé›†


ä½•ã‹è³ªå•ã€æ‚©ã¿äº‹ã€ç›¸è«‡ãªã©ã‚ã‚Œã°LINEã‚ªãƒ¼ãƒ—ãƒ³ãƒãƒ£ãƒƒãƒˆã‚‚ã”åˆ©ç”¨ãã ã•ã„ã€‚

https://line.me/ti/g2/eEPltQ6Tzh3pYAZV8JXKZqc7PJ6L0rpm573dcQ





# Twitter


https://twitter.com/YumaInaura


<!-- Update From Qiita API -->


