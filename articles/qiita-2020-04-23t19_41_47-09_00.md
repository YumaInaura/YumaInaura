---
title: "#Ruby Json parse + object_class ( NameError: no member 'xxx' in  ) ( e"
emoji: "ğŸ–¥"
type: "tech"
topics: ["Ruby"]
published: true
published_at: 2020-04-23t19:41
---

- JSON paras ã™ã‚‹ã¨ãã® object_class ã®æŒ‡å®šã ã¨ã€ Struct ã«å®šç¾©ã—ã¦ã„ãªã„ã‚­ãƒ¼ãŒ JSON ã«å«ã¾ã‚Œã‚‹å ´åˆã«ã€ã‚¨ãƒ©ãƒ¼ã‚’èµ·ã“ã—ã¦ã—ã¾ã†ã‚ˆã†ã  ( initialize ã™ã‚‹ã¨ãã«ä½™è¨ˆãªã‚­ãƒ¼ãŒæŒ‡å®šã•ã‚Œã‚‹ã‚ã‘ã ã‹ã‚‰ã€å½“ãŸã‚Šå‰ã‹ )
- object_class ã®æŒ‡å®šã«ä»»ã›ãšã€Struct ã‚’ç›´æ¥åˆ©ç”¨ã™ã‚Œã°ã€é ‘å¼µã£ã¦å¿…è¦ãªã‚­ãƒ¼ã ã‘ã§ Struct ã‚’çµ„ã¿ç«‹ã¦ã‚‹äº‹ã¯ã§ãã‚‹
- ä»–ã«ãªã«ã‹è‰¯ã„æŒ‡å®šãªã„ã‚“ã ã‚ã†ã‹

```rb
require "JSON"

# OK
User = Struct.new("User", :id, :name, :email)

json_string = { id: 1, name: "Alice", email: "aaa@example.com"}.to_json

user = JSON.parse(json_string, object_class: User)
# => #<struct Struct::User id=1, name="Alice", email="aaa@example.com">


# NG
# undefined Struct key in JSON
User = Struct.new("User", :id, :name, :email)

json_string = { id: 1, name: "Alice", email: "aaa@example.com", undefined_key: "xxx"}.to_json

user = JSON.parse(json_string, object_class: User)
# NameError: no member 'undefined_key' in struct

# OK
# generate struct by yourself
User = Struct.new("User", :id, :name, :email)

json_string = { id: 1, name: "Alice", email: "aaa@example.com", undefined_key: "xxx"}.to_json

user_attributes = JSON.parse(json_string)
# => {"id"=>1, "name"=>"Alice", "email"=>"aaa@example.com", "undefined_key"=>"xxx"}

User.new(user_attributes["id"], user_attributes["name"], user_attributes["email"])
# => #<struct Struct::User id="xxx", name="zzz", email="aaa">

```

# Original by Github issue

https://github.com/YumaInaura/YumaInaura/issues/3086











<!-- Update From Qiita API -->

# ãƒãƒ£ãƒƒãƒˆãƒ¡ãƒ³ãƒãƒ¼å‹Ÿé›†


ä½•ã‹è³ªå•ã€æ‚©ã¿äº‹ã€ç›¸è«‡ãªã©ã‚ã‚Œã°LINEã‚ªãƒ¼ãƒ—ãƒ³ãƒãƒ£ãƒƒãƒˆã‚‚ã”åˆ©ç”¨ãã ã•ã„ã€‚

https://line.me/ti/g2/eEPltQ6Tzh3pYAZV8JXKZqc7PJ6L0rpm573dcQ





# Twitter


https://twitter.com/YumaInaura


<!-- Update From Qiita API -->



# å…¬é–‹æ—¥æ™‚

2020-04-23
