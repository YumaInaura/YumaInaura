---
title: "#Ruby â€“ UTF8 SJIS ã§ã®ãƒ•ã‚¡ã‚¤ãƒ«æ›¸ãè¾¼ã¿ã€èª­ã¿è¾¼ã¿ã®æŒ™å‹•ã‚’è©¦ã™"
emoji: "ğŸ–¥"
type: "tech"
topics: ["Ruby"]
published: true
published_at: 2020-01-26
---

```rb

# -----------------------------------------------------------
# String ã®ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰
# -----------------------------------------------------------

# æ—¥æœ¬èªã‚’æ–‡å­—åˆ—ã¨ã—ã¦ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã—ãŸçµæœ
'ã‚'.encode(Encoding::SJIS)
# => "\x{82A0}"

# Stringçš„ã«UTf_8ã«ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã—ç›´ã™ã¨ã€UTf_8ã«æˆ»ã‚‹
"ã‚".encode(Encoding::SJIS).encode(Encoding::UTF_8)
# => "ã‚"

# -----------------------------------------------------------
# A. UTF8ã®æ–‡å­—åˆ—ã‚’ UTF_8æŒ‡å®šã§ ãƒ•ã‚¡ã‚¤ãƒ«ã«æ›¸ãè¾¼ã‚€
# -----------------------------------------------------------
File.write('tmp/utf8.txt', 'ã‚', encoding: Encoding::UTF_8)
# => 3

# å½“ãŸã‚Šå‰ã ãŒUTF_8ã§èª­ã‚ã‚‹
File.read('tmp/utf8.txt', encoding: Encoding::UTF_8)
# => "ã‚"

# SJIS ã§ã¯èª­ã‚ãªã„
File.read('tmp/utf8.txt', encoding: Encoding::SJIS)
# Encoding::InvalidByteSequenceError: incomplete "\x82" on Windows-31J

# -----------------------------------------------------------
# B. SJIS ã«ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã—ãŸæ–‡å­—åˆ—ã‚’ UTF_8æŒ‡å®šã§ ãƒ•ã‚¡ã‚¤ãƒ«ã«æ›¸ãè¾¼ã‚€
# -----------------------------------------------------------
File.write('tmp/sjis_string.txt', 'ã‚'.encode(Encoding::SJIS), encoding: Encoding::UTF_8)
# => 3

# ãªãœã‹UTF_8ã§èª­ã‚ã‚‹
File.read('tmp/sjis_string.txt', encoding: Encoding::UTF_8)
# => "ã‚"

# SJIS ã§ã¯èª­ã‚ãªã„
File.read('tmp/sjis_string.txt', encoding: Encoding::SJIS)
# Encoding::InvalidByteSequenceError: incomplete "\x82" on Windows-31J

# æ–‡å­—åˆ—ã®Stringã§ã‚“ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã¯ç„¡è¦–ã•ã‚Œã¦ã€Aãƒ‘ã‚¿ãƒ¼ãƒ³ã¨å…¨ãåŒã˜æŒ™å‹•ã«ãªã£ã¦ã„ã‚‹ã‚ˆã†ãªæ°—ãŒã—ãŸ
# File.write ãŒã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰é–¢ä¿‚ã‚’ã™ã¹ã¦ã†ã¾ããƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã—ã¦ãã‚Œã¦ã„ã‚‹ã®ã‹ã‚‚ã—ã‚Œãªã„

# -----------------------------------------------------------
# UTF_8ã®æ–‡å­—åˆ—ã‚’ SJISæŒ‡å®šã§ãƒ•ã‚¡ã‚¤ãƒ«ã«æ›¸ãè¾¼ã‚€
# -----------------------------------------------------------
File.write('tmp/sjis_encoding.txt', 'ã‚', encoding: Encoding::SJIS)
# => 2

# UTF8ã§èª­ã‚€ã¨ã“ã®ã‚ˆã†ãªæ–‡å­—åˆ—ãŒè¿”ã‚‹
File.read('tmp/sjis_encoding.txt', encoding: Encoding::UTF_8)
# => "\x82\xA0"

# æ–‡å­—åˆ—è‡ªä½“ã‚’UTF_8ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã—ã¦ã‚‚ä½•ã‚‚å¤‰ã‚ã‚‰ãªã„
# ä½•ã‹è‡ªåˆ†ãŒã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã‚„ãƒ‡ã‚³ãƒ¼ãƒ‰ã®é–¢ä¿‚ã‚’æ ¹æœ¬çš„ã«ç†è§£ã—ã¦ã„ãªã„æ°—ã¯ã™ã‚‹
File.read('tmp/sjis_encoding.txt', encoding: Encoding::UTF_8).encode(Encoding::UTF_8)
# => "\x82\xA0"

# SJISæŒ‡å®šã‚’ã—ã¦ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã‚“ã æ™‚ã«UTF_8ã®æ–‡å­—åˆ—ãŒè¿”ã‚‹
File.read('tmp/sjis_encoding.txt', encoding: Encoding::SJIS)
# => "ã‚"



```

# Original by Github issue

https://github.com/YumaInaura/YumaInaura/issues/2962








<!-- Update From Qiita API -->

# ãƒãƒ£ãƒƒãƒˆãƒ¡ãƒ³ãƒãƒ¼å‹Ÿé›†


ä½•ã‹è³ªå•ã€æ‚©ã¿äº‹ã€ç›¸è«‡ãªã©ã‚ã‚Œã°LINEã‚ªãƒ¼ãƒ—ãƒ³ãƒãƒ£ãƒƒãƒˆã‚‚ã”åˆ©ç”¨ãã ã•ã„ã€‚

https://line.me/ti/g2/eEPltQ6Tzh3pYAZV8JXKZqc7PJ6L0rpm573dcQ





# Twitter


https://twitter.com/YumaInaura


<!-- Update From Qiita API -->



# å…¬é–‹æ—¥æ™‚

2020-01-26
