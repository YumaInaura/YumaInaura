---
title: "#Slack API ã‚’å©ã„ã¦å…¨ãƒ¡ãƒ³ãƒãƒ¼ã‚’ä¸€å€‹ã®ãƒãƒ£ãƒ³ãƒãƒ«ã«æ‹›å¾…ã™ã‚‹ #python ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®ä¾‹ (é›‘ãƒãƒ¼ã‚¸ãƒ§ãƒ³)"
emoji: "ğŸ–¥"
type: "tech"
topics: ["Python", "Slack"]
published: true
---

# ATTENTION

- ãƒãƒ£ãƒ³ãƒãƒ«IDã®å–å¾—æ–¹æ³•ã¯é©å½“ã«ã‚°ã‚°ã‚‹ (ãƒãƒ£ãƒ³ãƒãƒ«åã§ã¯ãªã„)
- Slack App ã‚’ç™»éŒ²ã—ã¦ Tokenã‚’å¾—ã¦ã€é©åˆ‡ãª Permission ã‚’è¨­å®šã—ã¦ãŠã
- ãƒ¡ãƒ³ãƒãƒ¼æ•°ãŒå¤šã„å ´åˆã«ã¯å¯¾å¿œã—ã¦ã„ãªã„ã€ãƒšãƒ¼ã‚¸ãƒ³ã‚°ã«å¯¾å¿œã—ã¦ã„ãªã„
- é‡è¤‡æ‹›å¾…ã§ã‚¨ãƒ©ãƒ¼ãŒè¿”ã£ã¦ãã‚‹å•é¡Œã«ã‚‚å¯¾å¿œã—ã¦ã„ãªã„
- APIåˆ¶é™ã«å¼•ã£ã‹ã‹ã£ãŸã‚‰é©å½“ã« sleep å…¥ã‚Œã‚‹ãªã‚Šã—ã¦å¯¾å‡¦ã—ã¦ãã ã•ã„
- ä¾‹ã§ã¯ç„¡æ„å‘³ã« jq ã‚³ãƒãƒ³ãƒ‰ã‹ã¾ã—ã¦ã¾ã™

# all-member-list.py

```py
#!/usr/bin/env python3

# https://api.slack.com/methods/users.list

import requests, os, json

url = "https://slack.com/api/users.list"

params = {
  "token" : os.environ.get('SLACK_TOKEN'),
}

headers = {
  'Content-type': 'application/json'
}

res = requests.get(url, headers=headers, params=params)

print(json.dumps(res.json()))

```

# invite-to-channel.py

```py
#!/usr/bin/env python3

# https://api.slack.com/methods/channels.invite
# https://slack.com/api/channels.invite

import requests, os, json, sys

url = "https://slack.com/api/channels.invite"

members = json.loads(sys.stdin.read())

for member in members:
  params = {
    "token" : os.environ.get('SLACK_TOKEN'),
    "channel" : os.environ.get('CHANNEL'),
    "user" : member.get('id'),
  }
  
  headers = {
    'Content-type': 'application/json'
  }

  res = requests.post(url, headers=headers, params=params)

  print(json.dumps(res.json()))

```

# exe

```
export SLACK_TOKEN=xxxxxxxxxxxxxxxx && ./all-member-list.py | jq -r '.members' | CHANNEL=xxxxxxx ./invite-to-channel.py
```


# ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒãƒ£ãƒ³ãƒãƒ«ã‚’è¨­å®š

ä¸€åº¦å…¨å“¡æ‹›å¾…ã—ã¦ã‚‚ã€WorkSpaceã®ãƒ¡ãƒ³ãƒãƒ¼ãŒå¢—ãˆãŸã‚‰ã‚„ã‚Šç›´ã—ãªã®ã§ã€adminè¨­å®šã§ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒãƒ£ãƒ³ãƒãƒ«ã‚‚è¨­å®šã—ã¦ãŠãã¨è‰¯ã„ã‹ã‚‚

https://example.slack.com/admin/settings

![image](https://user-images.githubusercontent.com/13635059/58536882-a6caef00-822c-11e9-9f07-4d8b5fb7ea5c.png)

# æœ‰æ–™ãƒ—ãƒ©ãƒ³ãªã‚‰

- å…¨ãƒ¡ãƒ³ãƒãƒ¼ã‚’Slackã‚°ãƒ«ãƒ¼ãƒ—ã«å…¥ã‚Œã¦ãŠã
- ã‚°ãƒ«ãƒ¼ãƒ—ã«å¯¾ã—ã¦ invite ã™ã‚‹

ã£ã¦ã„ã†æ‰‹é †ã§ã€APIå©ã‹ãªãã¦ã‚‚ã§ãã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚

# Original by Github issue

https://github.com/YumaInaura/YumaInaura/issues/2067








<!-- Update From Qiita API -->

# ãƒãƒ£ãƒƒãƒˆãƒ¡ãƒ³ãƒãƒ¼å‹Ÿé›†


ä½•ã‹è³ªå•ã€æ‚©ã¿äº‹ã€ç›¸è«‡ãªã©ã‚ã‚Œã°LINEã‚ªãƒ¼ãƒ—ãƒ³ãƒãƒ£ãƒƒãƒˆã‚‚ã”åˆ©ç”¨ãã ã•ã„ã€‚

https://line.me/ti/g2/eEPltQ6Tzh3pYAZV8JXKZqc7PJ6L0rpm573dcQ





# Twitter


https://twitter.com/YumaInaura


<!-- Update From Qiita API -->


