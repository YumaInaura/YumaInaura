---
title: Docker åˆå¿ƒè€… â€” ssh ã§æ¥ç¶šã§ãã‚‹ã‚µãƒ¼ãƒãƒ¼ã‚’ç«‹ã¦ã‚‹
emoji: "ğŸ–¥"
type: "idea"
topics: ["SSH", "Docker"]
published: true
---

# è§£èª¬

dockerã ã‹ã‚‰ã¨ã„ã£ã¦ç‰¹åˆ¥ãªä½•ã‹ã‚’ã™ã‚‹ã‚ã‘ã§ã¯ãªã„ã€‚

é€šå¸¸ã®ã‚µãƒ¼ãƒãƒ¼ã¨åŒã˜ã‚ˆã†ã«ã€

- openssh ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹
- ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’è¨­å®šã™ã‚‹
- å¿…è¦ãªè¨­å®šã‚’æ›¸ãæ›ãˆã‚‹

ã¨ã„ã†ã“ã¨ã‚’é †ã«ãŠã“ãªã†ã€‚

# å‹•ä½œä¾‹ (Ubuntuã®å ´åˆ)

## Dockerfile

sed ã§å¼·å¼•ã« ssh ã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ›¸æ›ãˆãŸã‚Šã—ã¦ã„ã‚‹

```Dockerfile
FROM ubuntu:16.04

RUN apt-get update && apt-get install -y openssh-server
RUN mkdir /var/run/sshd
RUN echo 'root:screencast' | chpasswd
RUN sed -i 's/PermitRootLogin prohibit-password/PermitRootLogin yes/' /etc/ssh/sshd_config

# SSH login fix. Otherwise user is kicked off after login
RUN sed 's@session\s*required\s*pam_loginuid.so@session optional pam_loginuid.so@g' -i /etc/pam.d/sshd

ENV NOTVISIBLE "in users profile"
RUN echo "export VISIBLE=now" >> /etc/profile

EXPOSE 22
CMD ["/usr/sbin/sshd", "-D"]
```

( [Dockerize an SSH service | Docker Documentation](https://docs.docker.com/engine/examples/running_ssh_service/#build-an-eg_sshd-image) ã‚ˆã‚Š )

## ã‚¤ãƒ¡ãƒ¼ã‚¸ã®ä½œæˆ

```
$ docker image build . -t ssh_server
```

## ã‚³ãƒ³ãƒ†ãƒŠã®å®Ÿè¡Œ

é©å½“ãªãƒãƒ¼ãƒˆã‚’ç¹‹ã’ã‚‹ã€‚

```
$ docker run -d -p 10000:22 ssh_server
```

`[ã‚³ãƒ³ãƒ†ãƒŠID]` ãŒæ¨™æº–å‡ºåŠ›ã•ã‚Œã‚‹ã®ã§æ§ãˆã¦ãŠãã€‚


## sshã‚³ãƒãƒ³ãƒ‰ã§ã‚¢ã‚¯ã‚»ã‚¹

ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’èã‹ã‚Œã‚‹ã®ã§å…¥åŠ›ã™ã‚‹ã€‚( ã“ã®ä¾‹ã§ã¯ `screencast` )

```
ssh root@127.0.0.1 -p 10000
```

# ç’°å¢ƒ

- Docker version 17.06.1-ce, build 874a737








<!-- Update From Qiita API -->

# ãƒãƒ£ãƒƒãƒˆãƒ¡ãƒ³ãƒãƒ¼å‹Ÿé›†


ä½•ã‹è³ªå•ã€æ‚©ã¿äº‹ã€ç›¸è«‡ãªã©ã‚ã‚Œã°LINEã‚ªãƒ¼ãƒ—ãƒ³ãƒãƒ£ãƒƒãƒˆã‚‚ã”åˆ©ç”¨ãã ã•ã„ã€‚

https://line.me/ti/g2/eEPltQ6Tzh3pYAZV8JXKZqc7PJ6L0rpm573dcQ





# Twitter


https://twitter.com/YumaInaura


<!-- Update From Qiita API -->


