---
title: "#Rails ( #Ruby + ActiveSupport )  + Time.use_zone + travel_to ã§ç¾åœ°æ™‚åˆ»=æ—¥æœ¬"
emoji: "ğŸ–¥"
type: "tech"
topics: ["Ruby", "Rails"]
published: true
---

- ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³ã®9æ™‚é–“ã®æ‰±ã„ã‚’ä¸€ç”Ÿã‹ã‹ã£ã¦ã‚‚è¦šãˆã‚‰ã‚Œã‚‹æ°—ãŒã—ãªã„
- è¶³ã—ç®—ã¨å¼•ãç®—ã‚’é–“é•ãˆã‚‹ç¢ºç‡ãŒ65%
- Rubyã§éŠã‚“ã§ã„ãŸã‚‰ã ã‚“ã ã‚“åˆ†ã‹ã£ã¦ããŸæ°—ãŒã™ã‚‹ã‘ã‚Œã©
- ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³ã«æ…£ã‚Œè¦ªã—ã‚€ã ã‘ã§1é€±é–“ã‹ã‹ã£ã¦ã€3æ—¥ã§å¿˜ã‚Œã‚‹æ°—ãŒã—ãŸ


```rb
require 'active_support/core_ext'

# æ—¥æœ¬æ™‚é–“ã®å¹´å§‹ã®æ™‚é–“
jst_beggining_of_year = Time.use_zone('Tokyo') { Time.local(2020, 01, 01, 00, 00, 00) }

# travel ã™ã‚‹ãŸã‚ã«å¿…è¦
require 'active_support/testing/time_helpers'
include ActiveSupport::Testing::TimeHelpers

# æ—¥æœ¬æ™‚é–“ã®å¹´å§‹ã«æ™‚é–“ã‚’å›ºå®šã™ã‚‹
travel_to jst_beggining_of_year

# ä»Šæ—¥ã®æ—¥ä»˜ã¯ 2020-01-01
Date.current
# => Wed, 01 Jan 2020

# ç¾åœ¨æ™‚åˆ»ã¯ 2020-01-01 00:00:00 ã§ JST ã®ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³ã‚‚æŒã£ã¦ã„ã‚‹
Time.now
# => 2020-01-01 00:00:00 +0900

# ã“ã¡ã‚‰ã‚‚åŒã˜ã
Time.current
# => 2020-01-01 00:00:00 +0900

# Time.nowã¯Rubyã®classã ãŒã¡ã‚ƒã‚“ã¨travelã§ãã¦ã„ã‚‹
Time.now.class
# => Time

# Time.currentã¯Rails=ActiveSupportã®classã¿ãŸã„ã ãŒtravelã§ãã¦ã„ã‚‹
# Time.zone= ã‚’æŒ‡å®šã—ã¦ã„ãªã„å ´åˆã¯ Ruby ã® Time.now ã¨åŒã˜ã‚ˆã†ã«åƒãæ°—ãŒã—ãŸãŒåˆã£ã¦ã‚‹ã‹ãª
Time.current.class
# => ActiveSupport::TimeWithZone

# Time.zone.now ãƒ¡ã‚½ãƒƒãƒ‰ã§ã¯ã€Time.zoneã®æŒ‡å®šã‚’ã—ã¦ã„ãªã„ã®ã§ä½•ã‚‚å¾—ã‚‰ã‚Œãªã„
# Time.currentã¨ã¯æ‰±ã„ãŒé•ã†ã¿ãŸã„ã 
Time.zone.now
# NoMethodError: undefined method `now' for nil:NilClass

# Time.zone æŒ‡å®šã‚’æ—¥æœ¬æ™‚é–“ã«ã™ã‚‹
Time.zone = 'Tokyo'
# => "Tokyo"

# ç¾åœ¨æ™‚åˆ»ã¯ 2020-01-01 00:00:00 ã§ JST ã®ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³ã‚„æ›œæ—¥ã‚‚æŒã£ã¦ã„ã‚‹
Time.zone.now
# => Wed, 01 Jan 2020 00:00:00 JST +09:00

# Time.zone.now ã¯ ActiveSupport ã® class ã‚’æŒã£ã¦ã„ã‚‹
Time.zone.now.class
# => ActiveSupport::TimeWithZone

# ä»Šæ—¥ã®æ—¥ä»˜ã¯ 2020-01-01ã 
# ã“ã¡ã‚‰ã‚‚ Ruby ã§ã¯ãªã Rails = ActiveSupport ã®ã‚‚ã®
Date.current
# => Wed, 01 Jan 2020

# Time.zone æŒ‡å®šã‚’æ—¥æœ¬æ™‚é–“ã«ã™ã‚‹
Time.zone = 'UTC'
# => "UTC"

# UTCã§ã„ã†ã¨ä»Šæ—¥ã®æ—¥ä»˜ã¯ã¾ã ã€å‰å¹´ã®å¹´æœ«ã 
Date.current
# => Tue, 31 Dec 2019

# æ—¥æœ¬æ™‚é–“ã®å¹´å§‹ã®0æ™‚ã¯ã€UTCã§ã„ã†ã¨9æ™‚é–“é…ã„ã€å¹´æœ«ã®15æ™‚ã  
Time.zone.now
# => Tue, 31 Dec 2019 15:00:00 UTC +00:00


```


# Original by Github issue

https://github.com/YumaInaura/YumaInaura/issues/2775








<!-- Update From Qiita API -->

# ãƒãƒ£ãƒƒãƒˆãƒ¡ãƒ³ãƒãƒ¼å‹Ÿé›†


ä½•ã‹è³ªå•ã€æ‚©ã¿äº‹ã€ç›¸è«‡ãªã©ã‚ã‚Œã°LINEã‚ªãƒ¼ãƒ—ãƒ³ãƒãƒ£ãƒƒãƒˆã‚‚ã”åˆ©ç”¨ãã ã•ã„ã€‚

https://line.me/ti/g2/eEPltQ6Tzh3pYAZV8JXKZqc7PJ6L0rpm573dcQ





# Twitter


https://twitter.com/YumaInaura


<!-- Update From Qiita API -->


