---
title: "#Rails deny nill value but allow blank value validation / exclusion: {"
emoji: "ğŸ–¥"
type: "tech"
topics: ["Rails"]
published: true
published_at: 2020-02-20
---

# Model

```rb
class User < ApplicationRecord
  validates :name, exclusion: { in: [nil] }
end
```

# å‹•ä½œã‚¤ãƒ¡ãƒ¼ã‚¸

```rb
User.create!(name: nil)

ActiveRecord::RecordInvalid: åå‰ ã¯äºˆç´„ã•ã‚Œã¦ã„ã¾ã™

User.create!(name: "")
# æˆåŠŸ

```

# ã‚¬ã‚¤ãƒ‰

![image](https://user-images.githubusercontent.com/13635059/74790955-7831fe80-52fc-11ea-9df5-6190fcd23008.png)


https://railsguides.jp/active_record_validations.html


# presence ã¯ï¼Ÿ

ç©ºæ–‡å­—ã‚’ç¦æ­¢ã—ã¦ã—ã¾ã†

>2.9 presence
>ã“ã®ãƒ˜ãƒ«ãƒ‘ãƒ¼ã¯ã€æŒ‡å®šã•ã‚ŒãŸå±æ€§ãŒã€Œç©ºã§ãªã„ã€ã“ã¨ã‚’ç¢ºèªã—ã¾ã™ã€‚å€¤ãŒnilã‚„ç©ºæ–‡å­—ã§ãªã„(ã¤ã¾ã‚Šç©ºæ¬„ã§ã‚‚ãªã‘ã‚Œã°ãƒ›ãƒ¯ã‚¤ãƒˆã‚¹ãƒšãƒ¼ã‚¹ã§ã‚‚ãªã„)ã“ã¨ã‚’ç¢ºèªã™ã‚‹ãŸã‚ã«ã€å†…éƒ¨ã§blank?ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ã£ã¦ã„ã¾ã™ã€‚

```rb
class Person < ApplicationRecord
  validates :name, :login, :email, presence: true
end
```

# allow_blank ã¯ï¼Ÿ

å€¤ãŒæœªå…¥åŠ›ã€ç©ºæ–‡å­—ã®æ™‚ã«ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ã‚¹ã‚­ãƒƒãƒ—ã™ã‚‹ãŸã‚ã‚ªãƒ—ã‚·ãƒ§ãƒ³æŒ‡å®šã§ã‚ã‚Šã€ç©ºæ–‡å­—ã‚’è¨±å®¹ã™ã‚‹ã‚ã‘ã§ã¯ãªã„

>3.2 :allow_blank
>:allow_blankã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¯:allow_nilã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¨ä¼¼ã¦ã„ã¾ã™ã€‚ã“ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’æŒ‡å®šã™ã‚‹ã¨ã€å±æ€§ã®å€¤ãŒblank?ã«è©²å½“ã™ã‚‹å ´åˆï¼ˆnilã‚„ç©ºæ–‡å­—ãªã©ï¼‰ã«ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãŒãƒ‘ã‚¹ã—ã¾ã™ã€‚


```rb
class Topic < ApplicationRecord
  validates :title, length: { is: 5 }, allow_blank: true
end
 
Topic.create(title: "").valid?  # => true
Topic.create(title: nil).valid? # => true

```

# Original by Github issue

https://github.com/YumaInaura/YumaInaura/issues/2994








<!-- Update From Qiita API -->

# ãƒãƒ£ãƒƒãƒˆãƒ¡ãƒ³ãƒãƒ¼å‹Ÿé›†


ä½•ã‹è³ªå•ã€æ‚©ã¿äº‹ã€ç›¸è«‡ãªã©ã‚ã‚Œã°LINEã‚ªãƒ¼ãƒ—ãƒ³ãƒãƒ£ãƒƒãƒˆã‚‚ã”åˆ©ç”¨ãã ã•ã„ã€‚

https://line.me/ti/g2/eEPltQ6Tzh3pYAZV8JXKZqc7PJ6L0rpm573dcQ





# Twitter


https://twitter.com/YumaInaura


<!-- Update From Qiita API -->



# å…¬é–‹æ—¥æ™‚

2020-02-20
