---
title: "express.js ( node.js )  â€“ å…¬å¼ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ãŒåˆ†ã‹ã‚Šã¥ã‚‰ã„ã®ãŒè‡ªåŠ›ã§é€²ã‚ã‚‹"
emoji: "ğŸ–¥"
type: "tech"
topics: ["Node.js", "Express"]
published: true
published_at: 2023-08-26t23:10
---

# å•é¡Œ

Expressã®ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã¯åŸºç¤çš„ãªèª¬æ˜ãŒå¤šãèª­ã¿ã¥ã‚‰ãã¦ã‚„ã£ã¦ã‚‰ã‚Œãªã„ã€‚
ãã‚Œã‚ˆã‚Šã‚‚æ‰‹è»½ã«æ‰‹ã‚’å‹•ã‹ã—ãªãŒã‚‰å‹•ä½œã•ã›ãŸã„ã€‚

https://developer.mozilla.org/ja/docs/Learn/Server-side/Express_Nodejs/Tutorial_local_library_website

ã€Œåˆ†ã‹ã‚Šã«ãã„ã‚‚ã®ã‚’å™›ã¿ç •ã„ã¦ç†è§£ã™ã‚‹ã€‚ãã‚ŒãŒã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã®æœ¬åˆ†ã ã€
ãã†è‡ªåˆ†ã«è¨€ã„èã‹ã›ãªãŒã‚‰ã€‚

# ç’°å¢ƒ

- express 4.16.1
- npm 9.6.7
- MacOS

# æº–å‚™

npm ã¯ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ¸ˆã¿ã§ã‚ã‚‹ã“ã¨ã‚’å‰æã¨ã™ã‚‹

expressã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ãˆã‚‹ã‚ˆã†ã«ã™ã‚‹

```
npm install express-generator -g
```

# ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆ

ä»¥ä¸‹ã‚³ãƒãƒ³ãƒ‰ã§æŒ‡å®šãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª ( `express-locallibrary-tutorial` ) ã«expressãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãŒä½œã‚‰ã‚Œã‚‹

```
express express-locallibrary-tutorial --view=pug
```



```
cd express-locallibrary-tutorial
npm install
```

# ã‚µãƒ¼ãƒãƒ¼èµ·å‹•

```
 DEBUG=express-locallibrary-tutorial:* npm start
```

# Webã‚¢ã‚¯ã‚»ã‚¹

http://localhost:3000/ ã«ã‚¢ã‚¯ã‚»ã‚¹

ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ç”¨ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã§æ–‡å­—ã‚’å¤‰ãˆã¦ã¿ã‚‹

`views/index.pug`

```
extends layout

block content
  h1= title
  p Welcome!!!!!!!!!! to #{title}
```

![image](https://github.com/YumaInaura/YumaInaura/assets/13635059/e95a0779-06c5-4a39-b14a-40f42734a3e7)

# index.js ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å¤‰ãˆã¦ã¿ã‚‹

ãƒ•ã‚¡ã‚¤ãƒ«å¤‰æ›´ã ã‘ã§ã¯ãƒšãƒ¼ã‚¸ã®è¡¨ç¤ºã¯å¤‰ã‚ã‚‰ãªã‹ã£ãŸã€‚
ã‚µãƒ¼ãƒãƒ¼å†èµ·å‹•ã§å¤‰æ›´ãŒåæ˜ ã•ã‚ŒãŸã€‚

(ã‚µãƒ¼ãƒãƒ¼ãŒèµ·å‹•ã—ã¦ã„ã‚‹ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã®ã‚¿ãƒ–ã§ Ctrl + C ã‚’æŠ¼ã™ãªã©ã—ã¦åœæ­¢ã—ã¦ã‹ã‚‰å†åº¦ `npm start` ã•ã›ãŸ )

`routes/index.js`

```js
var express = require('express');
var router = express.Router();

/* GET home page. */
router.get('/', function(req, res, next) {
  res.render('index', { title: 'Expresssssss' }); // ã“ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å¤‰ãˆã‚‹
});

module.exports = router;
```

<img width="513" alt="image" src="https://github.com/YumaInaura/YumaInaura/assets/13635059/532bf6b5-0959-4e55-b546-6d3fbae528ba">


# DBã‚’ä½œã‚‹


å…¬å¼ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã¯ã“ã“ã‹ã‚‰ç‰¹ã«æ„å‘³ä¸æ˜ã«ãªã£ã¦ãã‚‹ã€‚
( https://developer.mozilla.org/ja/docs/Learn/Server-side/Express_Nodejs/mongoose )

ä½•ã‚’ã©ã®ãƒ•ã‚¡ã‚¤ãƒ«ã«æ›¸ã„ãŸã‚‰è‰¯ã„ã®ã‹ãŒå…¨ãè¦‹ãˆã¦ã“ãªã„ã€‚
expressã®ã‚³ãƒ¼ãƒ‰ã¨ã—ã¦DBé–¢ä¿‚ã®è¨˜è¿°ã‚’ã™ã‚‹ã®ã‹ãã‚Œã¨ã‚‚node.jså˜ä½“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ›¸ã‘ã¨ã„ã†ã“ã¨ãªã®ã‹ã€‚

## MonboDBã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

expressã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆDBã¯ mongodb ã®ã‚ˆã†ãªã®ã§ãã‚Œã‚’localã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚

https://www.npmjs.com/package/mongodb

ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã ã‘ã§ã‚‚ä¸€ç­‹ç¸„ã§ã¯ã„ã‹ãªã„ã‹ã‚‚ã—ã‚Œãªã„ã®ã§ç’°å¢ƒã«ã‚ˆã£ã¦ã¯ã¡ã‚‡ã£ã¨é ‘å¼µã‚‹å¿…è¦ãŒã‚ã‚‹ã‹ã‚‚ã—ã‚Œãªã„ã€‚
ä½•ã‚‰ã‹ã®æ–¹æ³•ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãƒ»èµ·å‹•ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚

Macã®å ´åˆ

mongodbæœ¬ä½“ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```
brew tap mongodb/brew
brew install mongodb-community
```


DBã‚µãƒ¼ãƒãƒ¼èµ·å‹•

```
brew services start mongodb-community
```

# mongoose 

## ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

ã“ã¡ã‚‰ã¯ DBæœ¬ä½“ã§ã¯ãªãDBã‚’æ“ä½œã™ã‚‹ãŸã‚ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ã‚ˆã†ã 

https://mongoosejs.com/

`npm install mongoose`

## å‹•ä½œç¢ºèª

mongooseã®å…¬å¼ã‚’å‚è€ƒã«nodeã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’æ›¸ã„ã¦DBæ“ä½œã‚’ã—ã¦ã¿ã‚‹ã¨ãƒ‡ãƒ¼ã‚¿ã®ä¿å­˜ã«æˆåŠŸã—ãŸ

https://mongoosejs.com/docs/index.html

ã‚³ãƒãƒ³ãƒ‰ä¾‹

`node example.js`

ãƒ•ã‚¡ã‚¤ãƒ«ä¾‹

```js

// https://mongoosejs.com/docs/index.html

const mongoose = require('mongoose')

main().catch(err => console.log(err))

async function main() {
  await mongoose.connect('mongodb://127.0.0.1:27017/test')

  // ã‚¹ã‚­ãƒ¼ãƒã®å®šç¾©
  const kittySchema = new mongoose.Schema({
    name: String
  })

  // ãƒ¢ãƒ‡ãƒ«ã«ã‚¹ã‚­ãƒ¼ãƒã‚’ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã™ã‚‹ (ã‚‰ã—ã„)
  const Kitten = mongoose.model('Kitten', kittySchema)

  // DBã«ä¿å­˜ã™ã‚‹
  const fluffy = new Kitten({ name: 'fluffy' })
  await fluffy.save()

  console.log('SAVE')

  // ç‰¹å®šã®æ¡ä»¶å¼ã§ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹
  // DBã¸ã®ä¿å­˜ãªã®ã§ã“ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’èµ·å‹•ã™ã‚‹ãŸã³ã«ãƒ‡ãƒ¼ã‚¿ãŒå¢—ãˆã‚‹

  // è¡¨ç¤ºä¾‹
  // [
  //   {
  //     _id: new ObjectId("64e9f4bb6576f87bdc838c0e"),
  //     name: 'fluffy',
  //     __v: 0
  //   },
  //   {
  //     _id: new ObjectId("64e9f4c7e16502c2c740eb72"),
  //     name: 'fluffy',
  //     __v: 0
  //   }
  // ]
  const kittens = await Kitten.find({ name: /^fluff/ });
  console.log(kittens)

  // ãƒ¬ã‚³ãƒ¼ãƒ‰å€‹æ•°ã‚’è¡¨ç¤º
  const count = await Kitten.count()
  console.log(count)
}

```

# ãƒšãƒ¼ã‚¸ã‚¢ã‚¯ã‚»ã‚¹ã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§DBä¿å­˜ã—ã¦ã¿ã‚‹

http://localhost:3000/ ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ãŸã³DBä¿å­˜ã™ã‚‹ã‚ˆã†ã«ã—ã¦ã¿ã‚‹
(å¤‰æ›´ã—ãŸã‚‰ã‚µãƒ¼ãƒãƒ¼å†èµ·å‹•ãŒå¿…è¦)

`routes/index.js`

```js
const mongoose = require('mongoose')

// https://mongoosejs.com/docs/index.html


mongoose.connect('mongodb://127.0.0.1:27017/test')

// ã‚¹ã‚­ãƒ¼ãƒã®å®šç¾©
const kittySchema = new mongoose.Schema({
  name: String
})

const Kitten = mongoose.model('Kitten', kittySchema)

var express = require('express');
var router = express.Router();

router.get('/', function(req, res, next) {
  // DBã«ä¿å­˜ã™ã‚‹
  const fluffy = new Kitten({ name: 'fluffy' })
  fluffy.save()

  res.render('index', { title: `Expresssssss` });
});

module.exports = router;
```

ã“ã†ã™ã‚‹ã¨ç¢ºã‹ã«ãƒšãƒ¼ã‚¸ã‚¢ã‚¯ã‚»ã‚¹ã®ãŸã³ã«DBã«ãƒ¬ã‚³ãƒ¼ãƒ‰ä¿å­˜ãŒã§ãã¦ã„ã‚‹ã‚ˆã†ã ã€‚
å…ˆç¨‹ã® node ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œã™ã‚Œã°DBã®ãƒ¬ã‚³ãƒ¼ãƒ‰æ•°ãŒåˆ†ã‹ã‚‹ã€‚

# DBã§å¾—ãŸãƒ‡ãƒ¼ã‚¿ã‚’ç”»é¢è¡¨ç¤ºã™ã‚‹ã«ã¯ï¼Ÿ

ã¾ã ã‚ˆãåˆ†ã‹ã£ã¦ã„ãªã„ã€‚

findã®çµæœã‚’ãã®ã¾ã¾è¡¨ç¤ºã•ã›ã‚ˆã†ã¨ã—ã¦ã‚‚ç„¡ç†ã ã£ãŸã€‚
ä»Šå¾Œã‚‚æ°—ãŒå‘ã„ãŸã‚‰ã‚„ã£ã¦ã¿ã‚‹ã€‚

# å‚è€ƒ

https://developer.mozilla.org/ja/docs/Learn/Server-side/Express_Nodejs/skeleton_website



# ãƒãƒ£ãƒƒãƒˆãƒ¡ãƒ³ãƒãƒ¼å‹Ÿé›†


ä½•ã‹è³ªå•ã€æ‚©ã¿äº‹ã€ç›¸è«‡ãªã©ã‚ã‚Œã°LINEã‚ªãƒ¼ãƒ—ãƒ³ãƒãƒ£ãƒƒãƒˆã‚‚ã”åˆ©ç”¨ãã ã•ã„ã€‚

https://line.me/ti/g2/eEPltQ6Tzh3pYAZV8JXKZqc7PJ6L0rpm573dcQ


# Twitter

https://twitter.com/YumaInaura


# å…¬é–‹æ—¥æ™‚

2023-08-26
