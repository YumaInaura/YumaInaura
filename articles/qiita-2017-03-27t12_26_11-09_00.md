---
title: "Goè¨€èª â€” slice ã¨ array ã¨ãƒã‚¤ãƒ³ã‚¿"
emoji: "ğŸ–¥"
type: "tech"
topics: ["Go", "åˆå¿ƒè€…"]
published: true
---

# ã¾ã¨ã‚

- ã‚¹ãƒ©ã‚¤ã‚¹ ã¯ é…åˆ— ã®ãƒ©ãƒƒãƒ‘ãƒ¼ã®ã‚ˆã†ãªã‚‚ã®ã€‚
- ã‚¹ãƒ©ã‚¤ã‚¹ ã¸ã®æ“ä½œã‚’ãŠã“ãªã†ã¨ã€å†…éƒ¨ã§ã¯ã„ã„æ„Ÿã˜ã§ é…åˆ—ã‚’æ“ä½œã—ã¦ãã‚Œã‚‹ã€‚ ã‚¹ãƒ©ã‚¤ã‚¹ ã¯ãã® é…åˆ— ã‚’å‚ç…§ã™ã‚‹ã€‚
- ã‚¹ãƒ©ã‚¤ã‚¹ ã¨ã„ã†åå‰ã«ã¯ ã€Œé…åˆ—ã®æ–­ç‰‡ã‚’ä½¿ã†ã€ã¨ã„ã†ãƒ‹ãƒ¥ã‚¢ãƒ³ã‚¹ãŒã‚ã‚‹ã‚ˆã†ã«æ„Ÿã˜ã‚‰ã‚Œã‚‹ã€‚
  - ã“ã®å‹•ä½œã‚’ä¾¿å®œçš„ã«ã€Œè¦ç´ æ•°ã‚’æ°—ã«ã—ãªã„ã‚¿ã‚¤ãƒ—ã®é…åˆ—ã€ã¨ã—ã¦æ‰±ãˆã‚‹ã‚¤ãƒ¡ãƒ¼ã‚¸ã€‚
- Gopher ã®é–“ã§ã¯ã€Œã‚¹ãƒ©ã‚¤ã‚¹ã ã‘ã§è‰¯ã„ã˜ã‚ƒã‚“ã€ã¨ã„ã†èª¬ã‚‚ã‚ã‚‹ã‚ˆã†ã ã€‚


# æ¤œè¨¼

## 1. é…åˆ—ã‚’ã‚¹ãƒ©ã‚¤ã‚¹ã™ã‚‹

é…åˆ—ã‹ã‚‰ä¸€éƒ¨ã®è¦ç´ ã ã‘ã‚’ã‚¹ãƒ©ã‚¤ã‚¹ã—ã¦ã¿ã‚‹ã€‚
(ã‚¹ãƒ©ã‚¤ã‚¹ã£ã¦ã„ã†åå‰é€šã‚Šã®ä½¿ã„æ–¹)

```go
array := [3]string {"Alice", "Bob", "Carol"}
slice := array[:2]
```

ä¸€éƒ¨ã®è¦ç´ ã ã‘ã‚’ã‚¹ãƒ©ã‚¤ã‚¹ã—ãŸã®ã§ã€å¾—ã‚‰ã‚Œã‚‹è¦ç´ æ•°ã¯ã€ã‚¹ãƒ©ã‚¤ã‚¹ã®ã»ã†ãŒä¸€å€‹å°‘ãªã„ã€‚
é…åˆ—ã«ã¯CarorlãŒã„ã‚‹ãŒã€ã‚¹ãƒ©ã‚¤ã‚¹ã«ã¯ã„ãªã„ã€‚

```
fmt.Println(array) // [Alice Bob Carol]
fmt.Println(slice) // [Alice Bob]
```


## 2. ã‚¹ãƒ©ã‚¤ã‚¹ã‚’å¤‰æ›´ã™ã‚‹

Alice ã‚’ Dave ã«å¤‰ãˆã¦ã¿ã‚‹ã€‚

```go
slice[0] = "Dave"
```

é…åˆ—ã¨ã‚¹ãƒ©ã‚¤ã‚¹ã®ä¸¡æ–¹ã§ã€Alice ãŒ Dave ã«å¤‰ã‚ã£ãŸã€‚
ã‚¹ãƒ©ã‚¤ã‚¹ã¯å®Ÿä½“ã§ã¯ãªãã€é…åˆ—ã‚’å‚ç…§ã—ã¦ã„ã‚‹ã‹ã‚‰ã ã€‚

```go
fmt.Println(array) // [Dave Bob Carol]
fmt.Println(slice) // [Dave Bob]
```

ã€Œã‚¹ãƒ©ã‚¤ã‚¹ã®åŸºåº•ã¨ãªã‚‹é…åˆ—ã€ã®ãƒã‚¤ãƒ³ã‚¿ã‚’è¦‹ã‚‹ã“ã¨ã‚‚å‡ºæ¥ã‚‹ã€‚

```go
underlying := (*reflect.SliceHeader)(unsafe.Pointer(&slice))
fmt.Println(underlying) // ä¾‹: &{842350559520 2 3}
```

## 3. é…åˆ—ã‚’å¤‰æ›´ã™ã‚‹

ä»Šåº¦ã¯ã‚¹ãƒ©ã‚¤ã‚¹ã§ã¯ãªãã€é…åˆ—å´ã®å€¤ã‚’å¤‰æ›´ã—ã¦ã¿ã‚‹ã€‚

```go
array[1] = "Eric"
```

é…åˆ—ã¨ã‚¹ãƒ©ã‚¤ã‚¹ã®ä¸¡æ–¹ã§ã€Bob ãŒ Eric ã«å¤‰ã‚ã£ãŸã€‚

```
fmt.Println(array) // [Dave Eric Carol]
fmt.Println(slice) // [Dave Eric]
```

å¼•ãç¶šãã‚¹ãƒ©ã‚¤ã‚¹ã¯åŒã˜ãƒã‚¤ãƒ³ã‚¿ã§é…åˆ—ã‚’å‚ç…§ã—ã¦ã„ã‚‹ã€‚

```go
fmt.Println(underlying) // ä¾‹: &{842350559520 2 3}
```

## 4. ã‚¹ãƒ©ã‚¤ã‚¹ã«è¦ç´ ã‚’è¿½åŠ ã™ã‚‹

2å€‹ã®è¦ç´ ãŒå¾—ã‚‰ã‚Œã¦ã„ã‚‹ã‚¹ãƒ©ã‚¤ã‚¹ã«ã€3å€‹ç›®ã®è¦ç´ ã‚’è¿½åŠ ã—ã¦ã¿ã‚‹ã€‚

```go
slice = append(slice, "Frank")
```

é…åˆ—ã®3å€‹ç›®ã®è¦ç´ ãŒå¤‰ã‚ã£ãŸã€‚ Carol ã¯ Frankã€€ã«ãªã£ãŸã€‚

```go
fmt.Println(array) // [Dave Bob Frank]
fmt.Println(slice) // [Dave Bob Frank]
```

ã‚¹ãƒ©ã‚¤ã‚¹ã® cap ã®å€¤ãŒ 2 ã‹ã‚‰ 3 ã«å¢—ãˆã¦ã„ã‚‹ãŒã€ãƒã‚¤ãƒ³ã‚¿ã¯å¤‰ã‚ã£ã¦ã„ãªã„ã€‚

```go
fmt.Println(underlying) // ä¾‹: &{842350559520 3 3}
```

## 5. é…åˆ—ã®è¦ç´ æ•°ã‚’è¶Šãˆã‚‹

Go ã§ã®é…åˆ—ã¯ã€è¦ç´ æ•°ã®æ±ºã¾ã£ãŸå‹ã ã€‚
ã¤ã¾ã‚Šã“ã®ä¾‹ã§ã„ã†ã¨ã€é…åˆ—ã¯3å€‹ã® string ã—ã‹æŒã£ã¦ã„ãªã„ã€‚ ( `[3]string` ã¨ã„ã†å‹ )

ã‚¹ãƒ©ã‚¤ã‚¹ã®æœ«å°¾ã«ã•ã‚‰ã«è¦ç´ ã‚’è¿½åŠ ã—ã¦ã¿ã‚‹ã€‚ 

```go
slice = append(slice, "Greg") 
```

- é…åˆ—ã®è¦ç´ æ•°ã¯ 3å€‹
- ã‚¹ãƒ©ã‚¤ã‚¹ã¯ãã®é…åˆ—ã‚’å‚ç…§ã—ã¦ã„ã‚‹

ã¨è€ƒãˆã‚‹ã¨ã€ã‚¹ãƒ©ã‚¤ã‚¹ã«4å€‹ç›®ã®è¦ç´ ã¯è¿½åŠ ã§ããªã„ã¯ãšã ãŒï¼Ÿ

çµæœã‚’è¦‹ã¦ã¿ã‚‹ã¨ã€ä»Šåº¦ã¯é…åˆ—ã¨ã‚¹ãƒ©ã‚¤ã‚¹ã§å¾—ã‚‰ã‚Œã‚‹å€¤ãŒå¤‰ã‚ã£ã¦ã„ã‚‹ã€‚
ã‚¹ãƒ©ã‚¤ã‚¹ã«ã ã‘ Greg ãŒè¿½åŠ ã•ã‚Œã¦ã„ã‚‹ã€‚

```go
fmt.Println(array) // [Dave Eric Frank]
fmt.Println(slice) // [Dave Eric Frank Greg]
```

è©¦ã—ã«ã€ã‚¹ãƒ©ã‚¤ã‚¹ã®1å€‹ç›®ã®è¦ç´ ã‚’å¤‰æ›´ã—ã¦ã¿ã‚‹ã€‚

```go
slice[0] = "Henry"
```

ãã†ã™ã‚‹ã¨ã€ã¾ãŸé…åˆ—ã¯å¤‰æ›´ã•ã‚Œã¦ã„ãªã„ã€‚
ã‚¹ãƒ©ã‚¤ã‚¹ã§ã ã‘ Dave ãŒ Henry ã«å¤‰ã‚ã£ã¦ã„ã‚‹ã€‚

```go
fmt.Println(array) // [Dave Eric Frank]
fmt.Println(slice) // [Henry Eric Frank Greg]
```

ãƒã‚¤ãƒ³ã‚¿ã®çŠ¶æ…‹ã‚’è¦‹ã¦ã¿ã‚‹ã¨ã€ãƒã‚¤ãƒ³ã‚¿ã®å‚ç…§å…ˆãŒå¤‰ã‚ã£ã¦ã„ã‚‹ã€‚

```
fmt.Println(underlying) // ä¾‹: &{842350895200 4 6}
```

é…åˆ—ã¨ã‚¹ãƒ©ã‚¤ã‚¹ã®ã€Œãƒªãƒ³ã‚¯ã€ãŒåˆ‡ã‚ŒãŸçŠ¶æ…‹ã«ãªã£ãŸã‚ˆã†ã ã€‚

goã®ã‚¹ãƒ©ã‚¤ã‚¹ã¯ã€ä»Šå›ã®ã‚ˆã†ã«ã€é…åˆ—ã®è¦ç´ æ•°ã‚’è¶Šãˆã‚‹ã‚¹ãƒ©ã‚¤ã‚¹ã€‘ã‚’ä½œã£ãŸå ´åˆã€å†…éƒ¨çš„ã«æ–°ã—ã„é…åˆ—ã‚’ä½œã‚Šã€ä»Šåº¦ã¯ãã„ã¤ã‚’å‚ç…§ã™ã‚‹ã‚ˆã†ã«ãªã‚‹ã‚ˆã†ã ã€‚


# pointer / len / cap

ã¡ãªã¿ã«ã€ã‚¹ãƒ©ã‚¤ã‚¹ã¯ `ãƒã‚¤ãƒ³ã‚¿ / é•·ã•(len) / ã‚­ãƒ£ãƒ‘ã‚·ãƒ†ã‚£(cap)` ã¨ã„ã†æ§‹é€ ã«ãªã£ã¦ã„ã‚‹ãŒã€

æœ€åˆã®ãƒã‚¤ãƒ³ã‚¿ãŒ

- ã©ã®é…åˆ—ã‚’å‚ç…§ã™ã‚‹ã‹
- é…åˆ—ã®ä½•ç•ªç›®ã‹ã‚‰ä½•ç•ªç›®ã¾ã§ã‚’å‚ç…§ã™ã‚‹ã‹

ã‚’è¦šãˆã¦ã„ã¦ãã‚Œã¦ã„ã‚‹ã€‚

![image](https://qiita-image-store.s3.amazonaws.com/0/89618/6860fca6-0293-aed9-b48b-58579cee4b35.png)

( [Go Slices: usage and internals - The Go Blog](https://blog.golang.org/go-slices-usage-and-internals) ã‚ˆã‚Š )

- len ã¯ã‚¹ãƒ©ã‚¤ã‚¹ã§å¾—ã‚‰ã‚Œã‚‹è¦ç´ æ•°
- cap ã¯åŸºåº•ã¨ãªã‚‹é…åˆ—ã®è¦ç´ æ•°

ã£ã½ã„ã€‚

>The length of a slice is the number of elements it contains.
>The capacity of a slice is the number of elements in the underlying array, counting from the first element in the slice.

( [A Tour of Go](https://tour.golang.org/moretypes/11) ã‚ˆã‚Š )

ãŸã ã‚³ãƒ¼ãƒ‰ã®æœ€å¾Œã®ä¾‹ã§ cap ãŒ 3 ã‹ã‚‰ 6 ã«å¢—ãˆã¦ã„ã‚‹ã®ã¯è¬ãªã®ã§ã€ä»Šå¾Œèª¿ã¹ãŸã„ã€‚

# ã‚³ãƒ¼ãƒ‰å…¨ä½“

```go

package main

import(
	"fmt"
	"reflect"
	"unsafe"
)

func main() {
	array := [3]string {"Alice", "Bob", "Carol"} // é…åˆ—ã‚’ä½œã‚‹
	slice := array[:2] // é…åˆ—ã‹ã‚‰äºŒå€‹ã®è¦ç´ ã‚’ã‚¹ãƒ©ã‚¤ã‚¹ã™ã‚‹
	fmt.Println(array) // [Alice Bob Carol]
	fmt.Println(slice) // [Alice Bob]

	slice[0] = "Dave"  // ã‚¹ãƒ©ã‚¤ã‚¹ã®å…ˆé ­ã‚’å¤‰æ›´ã™ã‚‹
	fmt.Println(array) // [Dave Bob Carol] // é…åˆ—ã®å€¤ãŒå¤‰æ›´ã•ã‚Œã‚‹
	fmt.Println(slice) // [Dave Bob] // ã‚¹ãƒ©ã‚¤ã‚¹ã¯é…åˆ—ã‚’å‚ç…§ã—ã¦ã„ã‚‹

	underlying := (*reflect.SliceHeader)(unsafe.Pointer(&slice)) // ã‚¹ãƒ©ã‚¤ã‚¹ã®ãƒã‚¤ãƒ³ã‚¿ã‚’è¦‹ã¦ã¿ã‚‹
	fmt.Println(underlying) // ä¾‹: &{842350559520 2 3}

	array[1] = "Eric"  // ã‚¹ãƒ©ã‚¤ã‚¹ã§ã¯ãªãã€é…åˆ—å´ã®ä¸­èº«ã‚’å¤‰æ›´ã—ã¦ã¿ã‚‹
	fmt.Println(array) // [Dave Eric Carol] // Bob ãŒ Eric ã«å¤‰ã‚ã£ãŸ
	fmt.Println(slice) // [Dave Eric] // ã‚¹ãƒ©ã‚¤ã‚¹ã¯é…åˆ—ã‚’å‚ç…§ã—ã¦ã„ã‚‹ã®ã§ã€ã‚¹ãƒ©ã‚¤ã‚¹ã§å¾—ã‚‰ã‚Œã‚‹å€¤ã‚‚å¤‰ã‚ã‚‹

	fmt.Println(underlying) // ä¾‹: &{842350559520 2 3} // ãƒã‚¤ãƒ³ã‚¿ãŒåŒã˜

	slice = append(slice, "Frank") // ã‚¹ãƒ©ã‚¤ã‚¹ã®æœ«å°¾ã«è¦ç´ ã‚’è¿½åŠ ã™ã‚‹ // å¾—ã‚‰ã‚Œã‚‹è¦ç´ æ•°ã¯ä¸‰å€‹ã«ãªã‚‹
	fmt.Println(array) // [Dave Bob Frank] // é…åˆ—ã®ä¸‰å€‹ç›®ã®è¦ç´ ãŒå¤‰æ›´ã•ã‚ŒãŸ
	fmt.Println(slice) // [Dave Bob Frank] // ã‚¹ãƒ©ã‚¤ã‚¹ã¯é…åˆ—ã®è¦ç´ å…¨ã¦ã‚’å‚ç…§ã™ã‚‹ã‚ˆã†ã«ãªã£ãŸ 

	fmt.Println(underlying) // ä¾‹: &{842350559520 3 3} 

	slice = append(slice, "Greg") // ã‚¹ãƒ©ã‚¤ã‚¹ã®æœ«å°¾ã«ã•ã‚‰ã«è¦ç´ ã‚’è¿½åŠ ã™ã‚‹ // å‚ç…§å…ˆã®é…åˆ—ã®è¦ç´ æ•°ã‚’è¶Šãˆã¦4å€‹ã«ãªã‚Šãã†ã ãŒï¼Ÿ
	fmt.Println(array) // [Dave Eric Frank] // ä»Šåº¦ã¯é…åˆ—ã®çŠ¶æ…‹ã¯å¤‰ã‚ã£ã¦ã„ãªã„
	fmt.Println(slice) // [Dave Eric Frank Greg] // ã‚¹ãƒ©ã‚¤ã‚¹ã§å¾—ã‚‰ã‚Œã‚‹è¦ç´ æ•°ã¯å››å€‹ã«ãªã£ãŸ // ã‚¹ãƒ©ã‚¤ã‚¹ã¯é…åˆ—ã‚’å‚ç…§ã—ã¦ã„ãŸã¯ãšã§ã¯ï¼Ÿ

        fmt.Println(underlying) // ä¾‹: &{842350895200 4 6} // ãƒã‚¤ãƒ³ã‚¿ã®å‚ç…§å…ˆãŒå¤‰ã‚ã£ã¦ã„ã‚‹

	slice[0] = "Henry" // ã‚¹ãƒ©ã‚¤ã‚¹ã®æœ€åˆã®è¦ç´ ã‚’å¤‰æ›´ã™ã‚‹
	fmt.Println(array) // [Dave Eric Frank] // ä»Šåº¦ã‚‚é…åˆ—ã®çŠ¶æ…‹ã¯å¤‰ã‚ã£ã¦ã„ãªã„
	fmt.Println(slice) // [Henry Eric Frank Greg] // ã‚¹ãƒ©ã‚¤ã‚¹ã§å¾—ã‚‰ã‚Œã‚‹å€¤ã¯æœŸå¾…é€šã‚Šã«å¤‰ã‚ã£ã¦ã„ã‚‹

	fmt.Println(underlying) // ä¾‹: &{842350895200 4 6} // ãƒã‚¤ãƒ³ã‚¿ã®å‚ç…§å…ˆãŒå¤‰ã‚ã£ã¦ã„ã‚‹
}
```


# ç’°å¢ƒ

- go version go1.8 darwin/amd64

# æ„Ÿæƒ³

- ä½ç´šè¨€èªã®ä»•çµ„ã¿ã‚’çŸ¥ã‚Œã¦è‰¯ã‹ã£ãŸã€‚
- å½“ãŸã‚Šå‰ã ãŒé«˜ç´šè¨€èªã§ã‚‚å†…éƒ¨çš„ã«ã¯ã€ã“ã†ã„ã£ãŸã“ã¨ãŒãŠã“ãªã‚ã‚Œã¦ã„ã‚‹ã‚“ã ã‚ã†ãªã¨æ€ã£ãŸã€‚
- é…åˆ—ã®æ‰±ã„ã²ã¨ã¤ã§ã‚‚ã€ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ã¨ã‹ã‚’æ°—ã«ã™ã‚‹æ°—æŒã¡ãŒå°‘ã—åˆ†ã‹ã£ãŸæ°—ãŒã™ã‚‹ã€‚

# å‚è€ƒ

- [Go Slices: usage and internals - The Go Blog](https://blog.golang.org/go-slices-usage-and-internals)
- [The curious case of Golang array and slices](https://medium.com/@hackintoshrao/the-curious-case-of-golang-array-and-slices-2565491d4335#.8bdmo4zdh)
- [How to get the underlying array of a slice in Go? - Stack Overflow](http://stackoverflow.com/questions/36706843/how-to-get-the-underlying-array-of-a-slice-in-go)









<!-- Update From Qiita API -->

# ãƒãƒ£ãƒƒãƒˆãƒ¡ãƒ³ãƒãƒ¼å‹Ÿé›†


ä½•ã‹è³ªå•ã€æ‚©ã¿äº‹ã€ç›¸è«‡ãªã©ã‚ã‚Œã°LINEã‚ªãƒ¼ãƒ—ãƒ³ãƒãƒ£ãƒƒãƒˆã‚‚ã”åˆ©ç”¨ãã ã•ã„ã€‚

https://line.me/ti/g2/eEPltQ6Tzh3pYAZV8JXKZqc7PJ6L0rpm573dcQ





# Twitter


https://twitter.com/YumaInaura


<!-- Update From Qiita API -->


