---
title: "rspec ã®è¨­å®šã§ã‚¿ã‚°æŒ‡å®šã®æœ‰ç„¡ã‚’åˆ¤å®šã™ã‚‹"
emoji: "ğŸ–¥"
type: "tech"
topics: ["RSpec"]
published: true
published_at: 2018-04-26t09:27
---

ã“ã‚“ãªæ„Ÿã˜

```rb
RSpec.configure do |config|
  if config.filter.rules[:some_tag]
    # do something
  else
    # do something
  end
end
```

# ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹

ã€Œç‰¹å®šã®ã‚¿ã‚°ãŒæŒ‡å®šã•ã‚Œãªã‹ã£ãŸæ™‚ã€ã«ã€Œå…¨ã¦ã®å‡¦ç†ã«beforeã®ãƒ•ãƒƒã‚¯ã‚’å…¥ã‚ŒãŸã„å ´åˆã€ã«åˆ©ç”¨ã—ãŸã€‚

æ¬¡ã®ã‚ˆã†ãª `before` ã§ã®ã‚¿ã‚°æŒ‡å®šã¯ã€
ã€Œrspecã‚³ãƒãƒ³ãƒ‰ã§ç‰¹å®šã®ã‚¿ã‚°ãŒæŒ‡å®šã•ã‚Œãªã‹ã£ãŸæ™‚ã«ã€ãƒ•ãƒƒã‚¯ãŒå®Ÿè¡Œã•ã‚Œã‚‹ã€ã®ã§ã¯ãªãã€
ã€Œç‰¹å®šã®ã‚¿ã‚°ãŒ `false` æŒ‡å®šã®ãƒ†ã‚¹ãƒˆãŒèµ°ã‚‹æ™‚ã«ã€ãƒ•ãƒƒã‚¯ã‚‚å®Ÿè¡Œã•ã‚Œã‚‹ã€ã¨ã„ã†å‹•ä½œã®ãŸã‚ã€‚

```rb
before :example, some_tag: false do
  # do something
end
``` 

## æ¤œè¨¼ã‚³ãƒ¼ãƒ‰ä¾‹

```rb
RSpec.configure do |config|
  # RUN CASES
  # rspec this_script.rb --tag=some_tag
  if config.filter.rules[:some_tag]
    puts 'FOUND some_tag'

    config.before :example do
      puts 'BEFORE WHEN some_tag FOUND'
    end
  # RUN CASES
  # rspec this_script.rb
  # rspec this_script.rb --tag=another_tag
  # rspec this_script.rb --tag=~some_tag ( exclude some_tag )
  else
    puts 'NOT FOUND some_tag'

    config.before :example do
      puts 'BEFORE WHEN some_tag NOT FOUND'
    end
  end

  # When specify no tags
  # This before do not run in "RUN WHEN some_tag: true" describe
  config.before :example, some_tag: false do
    puts 'BEFORE WHEN some_tag FALSE'
  end
end

RSpec.describe do
  describe 'RUN WHEN some tag: true', some_tag: true do
    subject { true }
    it { is_expected.to be true }
  end

  describe 'RUN WHEN some_tag: false', some_tag: false do
    subject { true }
    it { is_expected.to be true }
  end
end
```

## å®Ÿè¡Œä¾‹

`some_tag: false` ãŒæŒ‡å®šã•ã‚Œã¦ã„ãªã„ãƒ†ã‚¹ãƒˆ ( `describe` å†… )ã§ã‚‚ã€before å‡¦ç†ãŒå®Ÿè¡Œã•ã‚Œã¦ã„ã‚‹ã®ãŒåˆ†ã‹ã‚‹ã€‚

```bash
$ bundle exec rspec -fd rspec/tags_existence_in_configure.rb

NOT FOUND some_tag


  RUN WHEN some tag: true
BEFORE WHEN some_tag NOT FOUND
    should equal true
  RUN WHEN some_tag: false
BEFORE WHEN some_tag NOT FOUND
BEFORE WHEN some_tag FALSE
    should equal true

Finished in 0.00881 seconds (files took 0.56641 seconds to load)
2 examples, 0 failures
```

# ç’°å¢ƒ

```
RSpec 3.7
  - rspec-core 3.7.1
  - rspec-expectations 3.7.0
  - rspec-mocks 3.7.0
  - rspec-support 3.7.1
```

# Gist

- [Rspec : check tag existence in configure](https://gist.github.com/YumaInaura/0a5db355704e6cc027814c973f83df12)

# å‚è€ƒ

- [Class: RSpec::Core::FilterRules â€” Documentation for rspec/rspec-core (master)](http://www.rubydoc.info/github/rspec/rspec-core/RSpec/Core/FilterRules)









<!-- Update From Qiita API -->

# ãƒãƒ£ãƒƒãƒˆãƒ¡ãƒ³ãƒãƒ¼å‹Ÿé›†


ä½•ã‹è³ªå•ã€æ‚©ã¿äº‹ã€ç›¸è«‡ãªã©ã‚ã‚Œã°LINEã‚ªãƒ¼ãƒ—ãƒ³ãƒãƒ£ãƒƒãƒˆã‚‚ã”åˆ©ç”¨ãã ã•ã„ã€‚

https://line.me/ti/g2/eEPltQ6Tzh3pYAZV8JXKZqc7PJ6L0rpm573dcQ





# Twitter


https://twitter.com/YumaInaura


<!-- Update From Qiita API -->



# å…¬é–‹æ—¥æ™‚

2018-04-26
