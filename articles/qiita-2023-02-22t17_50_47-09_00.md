---
title: "(ãƒãƒ¼ã‚¸ãƒ§ãƒ³ 7.8.2)ã€d3.jsã€‘ãƒ„ãƒ¼ãƒ«ãƒãƒƒãƒ—ã‚’è¿½åŠ ã™ã‚‹æ–¹æ³• â€“ javascript"
emoji: "ğŸ–¥"
type: "idea"
topics: ["JavaScript", "d3.js"]
published: true
---

# å•é¡Œ

å¤ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®æ›¸ãæ–¹ã ã¨ mousemove ã§åº§æ¨™ãŒå–ã‚Œãªã„

`Uncaught TypeError: Cannot read properties of undefined (reading 'pageY')`

![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/89618/29e8b834-6ae4-81f4-ae75-b980d72ab2d8.png)


# è§£æ±º â€“ ã‚³ãƒ¼ãƒ‰ä¾‹

æ–°ã—ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«å¯¾å¿œã—ãŸæ›¸ãæ–¹ã«ã™ã‚‹ã¨å‹•ã„ãŸ

ã»ã¼å‚è€ƒã‚µã‚¤ãƒˆã®ã¾ã¾ã®ã‚³ãƒ¼ãƒ‰ã ãŒã€ä»¥ä¸‹ã®ç®‡æ‰€ã‚’å¤‰ãˆãŸã€‚

- mouseover ã§ã¯ç¬¬2å¼•æ•°ã§dataã‚’å—ã‘å–ã‚‹
- mousemove ã§ã¯ d3ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‹ã‚‰ã§ã¯ãªãeventæƒ…å ±ã‹ã‚‰åº§æ¨™ã‚’å¾—ã‚‹

```html
<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <style>
    svg {
      font: 10px sans-serif;
      background-color: #eee;
      text-align: right;
      padding: 3px;
      margin: 1px;
      color: #333;
    }

    .cirStyle {
      r: 8;
      fill: #BF5E5E;
      stroke-width: 3px;
      stroke: #73412F;
      opacity: 0.7;
    }

    .cirStyle:hover {
      r: 12;
      fill: #F2B705;
      stroke: #F29F05;
    }

    .tooltip {
      position: absolute;
      width: auto;
      height: auto;
      padding: 4px;
      font: 10px sans-serif;
      color: #fff;
      background: #333;
      -webkit-box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
      -moz-box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
      box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
      border-radius: 4px;
      visibility: hidden;
    }
  </style>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.2/d3.min.js"></script>

</head>

<body>
  <script>
    // 1. ãƒ‡ãƒ¼ã‚¿ã®æº–å‚™
    var dataset = [
      [1, 4],
      [2, 6],
      [3, 11],
      [4, 18],
      [5, 22],
      [6, 27],
      [7, 29],
      [8, 29],
      [9, 25],
      [10, 18],
      [11, 13],
      [12, 7],
    ];

    var width = 800; // ã‚°ãƒ©ãƒ•ã®æ¨ªå¹…
    var height = 600; // ã‚°ãƒ©ãƒ•ã®ç¸¦å¹…
    var margin = { "top": 40, "bottom": 80, "right": 40, "left": 80 };

    // tooltipç”¨divè¦ç´ è¿½åŠ 
    var tooltip = d3.select("body").append("div").attr("class", "tooltip");

    // SVGã®è¨­å®š
    var svg = d3.select("body").append("svg").attr("width", width).attr("height", height);

    // x,yè»¸ã‚¹ã‚±ãƒ¼ãƒ«ã®è¨­å®š
    var xScale = d3.scaleLinear()
      .domain([0, d3.max(dataset, function (d) { return d[0]; })])
      .range([margin.left, width - margin.right]);

    var yScale = d3.scaleLinear()
      .domain([0, d3.max(dataset, function (d) { return d[1]; })])
      .range([height - margin.bottom, margin.top]);

    // è»¸ã®è¡¨ç¤º
    var axisx = d3.axisBottom(xScale).ticks(5);
    var axisy = d3.axisLeft(yScale).ticks(5);

    svg.append("g")
      .attr("transform", "translate(" + 0 + "," + (height - margin.bottom) + ")")
      .call(axisx)
      .append("text")
      .attr("fill", "black")
      .attr("x", (width - margin.left - margin.right) / 2 + margin.left)
      .attr("y", 35)
      .attr("text-anchor", "middle")
      .attr("font-size", "10pt")
      .attr("font-weight", "middle")
      .text("æœˆ");

    svg.append("g")
      .attr("transform", "translate(" + margin.left + "," + 0 + ")")
      .call(axisy)
      .append("text")
      .attr("fill", "black")
      .attr("text-anchor", "middle")
      .attr("x", -(height - margin.top - margin.bottom) / 2 - margin.top)
      .attr("y", -35)
      .attr("transform", "rotate(-90)")
      .attr("font-weight", "middle")
      .attr("font-size", "10pt")
      .text("æœ€é«˜æ°—æ¸©");

    // ãƒ©ã‚¤ãƒ³ã®è¡¨ç¤º
    svg.append("g")
      .selectAll("circle")
      .data(dataset)
      .enter()
      .append("circle")
      .attr("cx", function (d) { return xScale(d[0]); })
      .attr("cy", function (d) { return yScale(d[1]); })
      .attr("r", 4)
      .attr("id", function (d, i) { return "id-" + i; })
      .classed("cirStyle", true)
      // ã‚¿ãƒƒãƒã‚¤ãƒ™ãƒ³ãƒˆè¨­å®š
      // ç¬¬2å¼•æ•°ã§dataã‚’å—ã‘å–ã‚‹
      .on("mouseover", function (event, data) {
        //  tooltip
        //  .style("visibility", "visible")
        //  .html(d[0] + "æœˆ" + "<br>æœ€é«˜æ°—æ¸©: " + d[1] + "â„ƒ");
        tooltip
          .style("visibility", "visible")
          .html(data[0] + "æœˆ" + "<br>æœ€é«˜æ°—æ¸©: " + data[1] + "â„ƒ");
      })
      // d3ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‹ã‚‰ã§ã¯ãªãeventæƒ…å ±ã‹ã‚‰åº§æ¨™ã‚’å¾—ã‚‹
      .on("mousemove", function (event) {
        // tooltip
        // .style("top", (d3.event.pageY - 20) + "px")
        // .style("left", (d3.event.pageX + 10) + "px");

        tooltip
          .style("top", (event.pageY - 20) + "px")
          .style("left", (event.pageX + 10) + "px");
      })
      .on("mouseout", function (d) {
        tooltip.style("visibility", "hidden");
      })
  </script>
</body>

</html>
```

# è¡¨ç¤ºä¾‹

![image](https://user-images.githubusercontent.com/13635059/220568677-7198d348-3177-47c4-9ddb-7b4b70e217c1.png)

# å‚è€ƒ


https://uxbear.me/d3-js-tooltip/


# ãƒãƒ£ãƒƒãƒˆãƒ¡ãƒ³ãƒãƒ¼å‹Ÿé›†


ä½•ã‹è³ªå•ã€æ‚©ã¿äº‹ã€ç›¸è«‡ãªã©ã‚ã‚Œã°LINEã‚ªãƒ¼ãƒ—ãƒ³ãƒãƒ£ãƒƒãƒˆã‚‚ã”åˆ©ç”¨ãã ã•ã„ã€‚

https://line.me/ti/g2/eEPltQ6Tzh3pYAZV8JXKZqc7PJ6L0rpm573dcQ


# Twitter

https://twitter.com/YumaInaura

