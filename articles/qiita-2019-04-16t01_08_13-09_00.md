---
title: "#Qiita #API ã§è¨˜äº‹ã‚’æ–°è¦ä½œæˆã™ã‚‹ #python ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®ä¾‹ ( #JSON ã§æ¨™æº–å…¥åŠ›ã‚’å—ã‘å–ã£ã¦è¤‡æ•°å€‹åŒæ™‚ä½œæˆ ) "
emoji: "ğŸ–¥"
type: "tech"
topics: ["Qiita", "Python", "API", "JSON"]
published: true
---

# what

- JSONé…åˆ—ã§è¤‡æ•°ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’æ¸¡ã™
- ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã§ title / body / tag ã‚’æŒ‡å®šã™ã‚‹
- private ã‚„ twitter ã¸ã®æŠ•ç¨¿ãªã©ã‚‚ã€è¨˜äº‹ã”ã¨ã«æŒ‡å®šã§ãã‚‹ã‚ˆã†ã«
- tag ã®æŒ‡å®šã¯ã‚„ã‚„éšå±¤ãŒè¤‡é›‘ãªã®ã§æ³¨æ„

# script

```py
#!/usr/bin/env python3
# -*- coding: utf-8 -*-

# https://qiita.com/api/v2/docs#item

import os, sys, requests, json

posts = json.loads(sys.stdin.read())

results = []

token = os.environ.get('QIITA_TOKEN')

headers = {
 'Authorization': 'Bearer {}'.format(token),
 'Content-Type': 'application/json',
}
 
api_url = 'https://qiita.com/api/v2/items'

for post in posts:

  if post.get('private'):
    private = True
  else:
    private = False

  if post.get('tweet'):
    tweet = True
  else:
    tweet = False

  item = {
      'title': post['title'],
      'body': post['body'],
      "coediting": False,
      'tags': post['tags'] if 'tags' in post else [{ "name": "test", "versions": [] }],
      'private': private,
      'tweet': tweet,
  }
 
  response = requests.post(api_url, headers=headers, json=item)
  
  results.append(response.json())
 
print(json.dumps(results))


```

# exe


```shell
$ echo '[{"title":"text", "body": "test\\n\\ntest", "private": true, "tags" : [ {"name":"wo", "versions": []} ] }, {"title":"text", "body": "test", "private": true }]' | QIITA_TOKEN=$(cat ~/.secret/qiita-token) ./item-post-json.py | jq .
```


```json
[
  {
    "rendered_body": "<p>test</p>\n\n<p>test</p>\n",
    "body": "test\n\ntest\n",
    "coediting": false,
    "comments_count": 0,
    "created_at": "2019-04-15T22:59:45+09:00",
    "group": null,
    "id": "bf91b70405783b1a2ccf",
    "likes_count": 0,
    "private": true,
    "reactions_count": 0,
    "tags": [
      {
        "name": "wo",
        "versions": []
      }
    ],
    "title": "text",
    "updated_at": "2019-04-15T22:59:45+09:00",
    "url": "https://qiita.com/YumaInaura/private/bf91b70405783b1a2ccf",
    "user": {
      "description": "https://www.wantedly.com/users/93140896 /  Ruby on Rails æ¥­å‹™çµŒé¨“ ç´„4å¹´ / Perl PHP Python Golang Linux Apache MySQL BigQuery Jenkins ansible ãªã© /  ã„ãªã†ã‚‰ã‚†ã†ã¾ / YumaInaura / ç¨²æµ¦æ‚ é¦¬",
      "facebook_id": "yumainaura",
      "followees_count": 184,
      "followers_count": 164,
      "github_login_name": "YumaInaura",
      "id": "YumaInaura",
      "items_count": 1241,
      "linkedin_id": "",
      "location": "Osaka",
      "name": "Inaura ã„ãªã†ã‚‰ ç¨²æµ¦ Yuma ã‚†ã†ã¾ æ‚ é¦¬",
      "organization": "",
      "permanent_id": 89618,
      "profile_image_url": "https://qiita-image-store.s3.amazonaws.com/0/89618/profile-images/1546214964",
      "team_only": false,
      "twitter_screen_name": "YumaInaura",
      "website_url": "http://twitter.com/yumainaura"
    },
    "page_views_count": null
  },
  {
    "rendered_body": "<p>test</p>\n",
    "body": "test\n",
    "coediting": false,
    "comments_count": 0,
    "created_at": "2019-04-15T22:59:45+09:00",
    "group": null,
    "id": "08e1d783e4f5a50fa814",
    "likes_count": 0,
    "private": true,
    "reactions_count": 0,
    "tags": [
      {
        "name": "test",
        "versions": []
      }
    ],
    "title": "text",
    "updated_at": "2019-04-15T22:59:45+09:00",
    "url": "https://qiita.com/YumaInaura/private/08e1d783e4f5a50fa814",
    "user": {
      "description": "https://www.wantedly.com/users/93140896 /  Ruby on Rails æ¥­å‹™çµŒé¨“ ç´„4å¹´ / Perl PHP Python Golang Linux Apache MySQL BigQuery Jenkins ansible ãªã© /  ã„ãªã†ã‚‰ã‚†ã†ã¾ / YumaInaura / ç¨²æµ¦æ‚ é¦¬",
      "facebook_id": "yumainaura",
      "followees_count": 184,
      "followers_count": 164,
      "github_login_name": "YumaInaura",
      "id": "YumaInaura",
      "items_count": 1241,
      "linkedin_id": "",
      "location": "Osaka",
      "name": "Inaura ã„ãªã†ã‚‰ ç¨²æµ¦ Yuma ã‚†ã†ã¾ æ‚ é¦¬",
      "organization": "",
      "permanent_id": 89618,
      "profile_image_url": "https://qiita-image-store.s3.amazonaws.com/0/89618/profile-images/1546214964",
      "team_only": false,
      "twitter_screen_name": "YumaInaura",
      "website_url": "http://twitter.com/yumainaura"
    },
    "page_views_count": null
  }
]
```

# image

![image](https://user-images.githubusercontent.com/13635059/56138745-73146c80-5fd2-11e9-81cf-3ab835ccddf8.png)


# Original by Github issue

https://github.com/YumaInaura/YumaInaura/issues/1298








<!-- Update From Qiita API -->

# ãƒãƒ£ãƒƒãƒˆãƒ¡ãƒ³ãƒãƒ¼å‹Ÿé›†


ä½•ã‹è³ªå•ã€æ‚©ã¿äº‹ã€ç›¸è«‡ãªã©ã‚ã‚Œã°LINEã‚ªãƒ¼ãƒ—ãƒ³ãƒãƒ£ãƒƒãƒˆã‚‚ã”åˆ©ç”¨ãã ã•ã„ã€‚

https://line.me/ti/g2/eEPltQ6Tzh3pYAZV8JXKZqc7PJ6L0rpm573dcQ





# Twitter


https://twitter.com/YumaInaura


<!-- Update From Qiita API -->


